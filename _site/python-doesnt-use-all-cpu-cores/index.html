<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Python Doesn&amp;#8217;t Use All CPU Cores</title>
  <meta name="description" content="Is your Python script refusing to use all CPU scores on your server, and just using 1 CPU core out of the 16 CPU cores?">

  <link rel="stylesheet" href="/css/main.css">
  <link rel="canonical" href="http://ckieric.webfactional.com/python-doesnt-use-all-cpu-cores/">
  <link rel="alternate" type="application/rss+xml" title="" href="http://ckieric.webfactional.com/feed.xml">
</head>


  <body>

    <header class="site-header">

  <div class="wrapper">

    <a class="site-title" href="/"></a>

    <nav class="site-nav">
      <a href="#" class="menu-icon">
        <svg viewBox="0 0 18 15">
          <path fill="#424242" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/>
          <path fill="#424242" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484 h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/>
          <path fill="#424242" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/>
        </svg>
      </a>

      <div class="trigger">
        
          
          <a class="page-link" href="/about/">About</a>
          
        
          
        
          
        
          
        
      </div>
    </nav>

  </div>

</header>


    <div class="page-content">
      <div class="wrapper">
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title" itemprop="name headline">Python Doesn&#8217;t Use All CPU Cores</h1>
    <p class="post-meta"><time datetime="2014-07-19T01:45:36-07:00" itemprop="datePublished">Jul 19, 2014</time> • <span itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name">lo</span></span></p>
  </header>

  <div class="post-content" itemprop="articleBody">
    <p>Is your Python script refusing to use all CPU scores on your server, and just using 1 CPU core out of the 16 CPU cores?</p>

<p>It could be that the core affinity is messed up.</p>

<p>As it turns out, some modules mess with the core affinity on import, which end up forcing your Python script to use only one CPU core in the end. Just add this before you run the Python script:</p>

<pre class="lang-py prettyprint prettyprinted" style="color: #000000;"><code>&lt;span class="pln"&gt;os&lt;/span&gt;&lt;span class="pun"&gt;.&lt;/span&gt;&lt;span class="pln"&gt;system&lt;/span&gt;&lt;span class="pun"&gt;(&lt;/span&gt;&lt;span class="str" style="color: #800000;"&gt;"taskset -p 0xffffffff %d"&lt;/span&gt;&lt;span class="pun"&gt;%&lt;/span&gt;&lt;span class="pln"&gt; os&lt;/span&gt;&lt;span class="pun"&gt;.&lt;/span&gt;&lt;span class="pln"&gt;getpid&lt;/span&gt;&lt;span class="pun"&gt;())&lt;/span&gt;</code></pre>

<p>And then voila! It looks right now!</p>

<p><a href="http://www.chioka.in/wp-content/uploads/2014/07/10495829_10204248476553916_8213806856117433374_o.jpg"><img class="aligncenter size-full wp-image-469" src="http://www.chioka.in/wp-content/uploads/2014/07/10495829_10204248476553916_8213806856117433374_o.jpg" alt="10495829_10204248476553916_8213806856117433374_o" width="1154" height="853" srcset="http://ckieric.webfactional.com/wp-content/uploads/2014/07/10495829_10204248476553916_8213806856117433374_o.jpg 1154w, http://ckieric.webfactional.com/wp-content/uploads/2014/07/10495829_10204248476553916_8213806856117433374_o-580x428.jpg 580w, http://ckieric.webfactional.com/wp-content/uploads/2014/07/10495829_10204248476553916_8213806856117433374_o-940x694.jpg 940w, http://ckieric.webfactional.com/wp-content/uploads/2014/07/10495829_10204248476553916_8213806856117433374_o-624x461.jpg 624w" sizes="(max-width: 1154px) 100vw, 1154px" /></a></p>

<p>You can find more details in this StackOverflow <a href="http://stackoverflow.com/questions/15639779/what-determines-whether-different-python-processes-are-assigned-to-the-same-or-d">thread</a>.</p>

  </div>

  <div id="disqus_thread"></div>
  <script>
      /**
       *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
       *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables
       */
      /*
      var disqus_config = function () {
          this.page.url = PAGE_URL;  // Replace PAGE_URL with your page's canonical URL variable
          this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
      };
      */
      (function() {  // DON'T EDIT BELOW THIS LINE
          var d = document, s = d.createElement('script');
          
          s.src = '//log0.disqus.com/embed.js';
          
          s.setAttribute('data-timestamp', +new Date());
          (d.head || d.body).appendChild(s);
      })();
  </script>
  <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>

</article>

      </div>
    </div>

    <footer class="site-footer">

  <div class="wrapper">

    <h2 class="footer-heading"></h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li></li>
          <li><a href="mailto:"></a></li>
        </ul>
      </div>

      <div class="footer-col footer-col-2">
        <ul class="social-media-list">
          

          
        </ul>
      </div>

      <div class="footer-col footer-col-3">
        <p>Things I left Hanging Around</p>
      </div>
    </div>

  </div>

</footer>


  </body>

</html>
