<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Python Doesn&#8217;t Use All CPU Cores</title>
  <meta name="description" content="Is your Python script refusing to use all CPU scores on your server, and just using 1 CPU core out of the 16 CPU cores?">

  <link rel="stylesheet" href="/css/main.css">
  <link rel="canonical" href="http://www.chioka.in/python-doesnt-use-all-cpu-cores/">
  <link rel="alternate" type="application/rss+xml" title="Garbled Notes" href="http://www.chioka.in/feed.xml" />

  <link rel="stylesheet" href="http://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">
  <link href='http://fonts.googleapis.com/css?family=PT+Sans:400,700' rel='stylesheet' type='text/css'>
  <link href='http://fonts.googleapis.com/css?family=Open+Sans:300,700' rel='stylesheet' type='text/css'>
</head>


  <body>

    <div class="site-header">

    <nav class="site-nav">
      <a href="#" class="menu-icon">
        <i class="fa fa-navicon fa-lg"></i>
      </a>

      <div class="trigger">
          <a class="page-link" href="/">Home</a>
        
          
          <a class="page-link" href="/about/">About</a>
          
        
          
        
          
        
          
        
      </div>
    </nav>


</div>


    <div class="page-content">
      <div class="wrapper">
        <div class="post">

  <header class="post-header">
     <h1 class="post-title">Python Doesn&#8217;t Use All CPU Cores</h1>
     <p class="post-meta">Posted on Jul 19, 2014 • lo</p>
  </header>

  <article class="post-content">
    <p>Is your Python script refusing to use all CPU scores on your server, and just using 1 CPU core out of the 16 CPU cores?</p>

<p>It could be that the core affinity is messed up.</p>

<p>As it turns out, some modules mess with the core affinity on import, which end up forcing your Python script to use only one CPU core in the end. Just add this before you run the Python script:</p>

<pre class="lang-py prettyprint prettyprinted" style="color: #000000;"><code>&lt;span class="pln"&gt;os&lt;/span&gt;&lt;span class="pun"&gt;.&lt;/span&gt;&lt;span class="pln"&gt;system&lt;/span&gt;&lt;span class="pun"&gt;(&lt;/span&gt;&lt;span class="str" style="color: #800000;"&gt;"taskset -p 0xffffffff %d"&lt;/span&gt;&lt;span class="pun"&gt;%&lt;/span&gt;&lt;span class="pln"&gt; os&lt;/span&gt;&lt;span class="pun"&gt;.&lt;/span&gt;&lt;span class="pln"&gt;getpid&lt;/span&gt;&lt;span class="pun"&gt;())&lt;/span&gt;</code></pre>

<p>And then voila! It looks right now!</p>

<p><a href="/wp-content/uploads/2014/07/10495829_10204248476553916_8213806856117433374_o.jpg"><img class="aligncenter size-full wp-image-469" src="/wp-content/uploads/2014/07/10495829_10204248476553916_8213806856117433374_o.jpg" alt="10495829_10204248476553916_8213806856117433374_o" width="1154" height="853" srcset="/wp-content/uploads/2014/07/10495829_10204248476553916_8213806856117433374_o.jpg 1154w, /wp-content/uploads/2014/07/10495829_10204248476553916_8213806856117433374_o-580x428.jpg 580w, /wp-content/uploads/2014/07/10495829_10204248476553916_8213806856117433374_o-940x694.jpg 940w, /wp-content/uploads/2014/07/10495829_10204248476553916_8213806856117433374_o-624x461.jpg 624w" sizes="(max-width: 1154px) 100vw, 1154px" /></a></p>

<p>You can find more details in this StackOverflow <a href="http://stackoverflow.com/questions/15639779/what-determines-whether-different-python-processes-are-assigned-to-the-same-or-d">thread</a>.</p>

  </article>

  <div align="center">
  	<a href="#">
  	<i class="fa fa-arrow-circle-up fa-2x"></i>
  	</a>
  </div>

  <div id="disqus_thread"></div>
  <script>
      /**
       *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
       *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables
       */
      /*
      var disqus_config = function () {
          this.page.url = PAGE_URL;  // Replace PAGE_URL with your page's canonical URL variable
          this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
      };
      */
      (function() {  // DON'T EDIT BELOW THIS LINE
          var d = document, s = d.createElement('script');
          
          s.src = '//log0.disqus.com/embed.js';
          
          s.setAttribute('data-timestamp', +new Date());
          (d.head || d.body).appendChild(s);
      })();
  </script>
  <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>

</div>

      </div>
    </div>

    <div class="footer center">

  Powered by <a href=http://jekyllrb.com target="_blank">Jekyll</a>

</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-8676829-1', 'auto');
  ga('send', 'pageview');
</script>


  </body>
</html>
